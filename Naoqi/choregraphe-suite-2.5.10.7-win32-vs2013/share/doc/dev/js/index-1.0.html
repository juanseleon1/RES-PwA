<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>QiMessaging JavaScript 1.0 &mdash; Aldebaran 2.5.9.8-r3 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.5.9.8-r3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Aldebaran 2.5.9.8-r3 documentation" href="../../index.html" />
    <link rel="up" title="Former Versions" href="../deprecated_sdks.html" />
    <link rel="next" title="NAOqi APIs" href="../../naoqi/index.html" />
    <link rel="prev" title="Former Versions" href="../deprecated_sdks.html" />
 
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115894784-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115894784-1');
</script>

<script type="text/javascript" src="https://cloud.aldebaran-robotics.com/static/js/topbar.js"></script>
<style>
div#hd::after {
  
  
  content: 'NAOqi 2.5';
  
  
  
  position: absolute;
  margin-top: -54px;
  right: -4px;
  font-size: 125%;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -o-transform: rotate(45deg);
  transform: rotate(45deg);
  }
</style>
<script>

$(window).ready(function () {

    //Aldebaran Top bar
     var barLinks = [];
     barLinks.push({'name':'Aldebaran Site', 'url':'http://www.aldebaran-robotics.com', 'click':'', 'img':'https://cloud.aldebaran-robotics.com/static/img/aldeb.png'});
     barLinks.push({'name':'Documentation', 'url':'../../index.html', 'click':"", 'img':''});
     function ShowBar(name, email, usertype) {
        var barParams = {
            'name'    : name,
            'email'   : email,
            'usertype': usertype,
            'loginfct': "FctLogin"
        }
        try { InitTopBar(barParams, barLinks); } catch (e) { console.log('Top Bar Init Failed'); }
    }
    ShowBar();

    var width_label = 0;
    $('dl.function-index dt > span').each(function () {
        $(this).css('width', 'auto');
        width_label = Math.max(width_label, $(this).width());
    }).width(width_label + 30);
    $('.sig-paren').width('auto');

    // first level navigation

    var buttonIds = [".naoqi", "pepper", "nao", "romeo"];
    for(id in buttonIds){
        $(id).removeClass("active");
    }
    //Aldebaran project
    if ($('.toctree-l1.current a').text().indexOf("Romeo ")==0){
        $(".romeo").toggleClass('active');
    }
    else if ($('.toctree-l1.current a').text().indexOf("Pepper ")==0){
        $(".pepper").toggleClass('active');
    }
    else if ($('.toctree-l1.current a').text().indexOf("NAO ")==0){
        $(".nao").toggleClass('active');
    }
    else if($('.toctree-l1.current a').text().indexOf("NAOqi ")==0){
        $(".naoqi").toggleClass('active');
    }

    //qibuild project
    if ($('.toctree-l1.current a').text().indexOf("Welcome to qiBuild documentation !")==0){
        $(".beginner").toggleClass('active');
    }
    else if ($('.toctree-l1.current a').text().indexOf("Advanced qibuild usage")==0){
        $(".advanced").toggleClass('active');
    }
    else if ($('.toctree-l1.current a').text().indexOf("Hacking qiBuild")==0){
        $(".hacking").toggleClass('active');
    }

    // add "On this page", add cssClasses
    if($('.yui-g .section h1').length > 0){
        $('.yui-g .section h1:first').addClass("titleWrapper");
        $('.yui-g .section h1:first').after($("#on-this-page").html())
    }
    else if($('.yui-g .section h2').length > 0){
        $('.yui-g .section h2:first').addClass("titleWrapper");
        $('.yui-g .section h2:first').after($("#on-this-page").html())
    }
    //remove first element on this page
    if($("#on-this-page").length > 0){
        var doms = $(".yui-g .section :first").nextUntil("#toc-list");
        doms = doms.add($("#toc-list"));
        doms.wrapAll('<div class="iNavWrapper"></div>');
        $("#toc-list ul li a:first").remove()
        $("#toc-list ul:first").replaceWith($("#toc-list ul li").html())
    }
    $("#toc-list").hide();
    $("#otp-link").click(function(){
        $("#toc-list").slideToggle();
        if($("h2#otp-link").hasClass("change-before")){
            $("h2#otp-link").removeClass("change-before")
        }
        else{
            $("h2#otp-link").addClass("change-before")
        }
    });

    if($("a.current.reference.internal").length>0){
        var left = $("a.current.reference.internal").position().left-1;
        var width = $("a.current.reference.internal").width();
        var offset = 51;
        var sidebarWidth = 339;
        var right = sidebarWidth - (left + width + offset);
        if($("a.current.reference.internal").height() <= 15){
            $("a.current.reference.internal").css("white-space","nowrap");
            $("a.current.reference.internal").css({"backgroundColor":"#0F2939","paddingTop":"2px", "paddingBottom":"2px","paddingLeft":left+"px","marginLeft":"-"+left+"px", "paddingRight":right+"px","marginRight":"-"+right+"px", "boxShadow":"0px 0px 1px rgb(15, 41, 57)"});
        }
        else{
            $("a.current.reference.internal").css({"float":"right","backgroundColor":"#0F2939","paddingTop":"2px", "paddingBottom":"2px","paddingLeft":left+"px","marginLeft":"-"+left+"px", "paddingRight":right+"px","marginRight":"-"+right+"px", "boxShadow":"0px 0px 1px rgb(15, 41, 57)"});
            left = $("a.current.reference.internal").position().left-1;
            width = $("a.current.reference.internal").width();
            right = sidebarWidth - (left + width + offset);
            $("a.current.reference.internal").css({"float":"right","backgroundColor":"#0F2939","paddingTop":"2px", "paddingBottom":"2px","paddingLeft":left+"px","marginLeft":"-"+left+"px", "paddingRight":right+"px","marginRight":"-"+right+"px", "boxShadow":"0px 0px 1px rgb(15, 41, 57)"});
        }
        $("a.current.reference.internal").parent().css("list-style-type","none");
    }

    //back to top
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700;
    //grab the "back to top" link
    var back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
        //back to top button
        ( $(this).scrollTop() > offset ) ? back_to_top.addClass('cd-is-visible') : back_to_top.removeClass('cd-is-visible cd-fade-out');
        if( $(this).scrollTop() > offset_opacity ) {
            back_to_top.addClass('cd-fade-out');
        }
    });

    //smooth scroll to top
    back_to_top.click(function(event){
        event.preventDefault();
        $('body,html').animate({
            scrollTop: 0 ,
        }, scroll_top_duration
        );
    });
    //add show source button

    //replace "go" with "search"
    $("#searchbox form input[type=submit]").val("Search")

    //trigger click on version triangle to jump to whats new
    $("#hd").click(function(e){if(e.pageX >= this.offsetWidth && e.pageY<120){$(".whatsnew")[0].click()}})
})

</script>


  </head>
  <body role="document">

    <div class="document">
  <div id="custom-doc" class="yui-t3">
    <div id="hd">
      
      <h1><a href="../../index.html">SoftBank Robotics documentation</a>
      
      
      <span><a class="whatsnew" href="../../news/index.html" >
      
          What's new in NAOqi 2.5?
      
      </a></span>
      
      </h1>
      <div id="global-nav">
        
        <a class="naoqi" title="NAOqi Developer guide" href="../../index_dev_guide.html">NAOqi</a>
        <a class="pepper" title="Pepper documentation" href="../../home_pepper.html">Pepper</a>
        <a class="nao" title="NAO documentation" href="../../home_nao.html">NAO</a>
        <a class="romeo" title="Romeo Documentation" href="../../home_romeo.html">Romeo</a>
        
        
        
        <div class="nav">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script></div>
      </div>

    </div>
    <main class="cd-container">
        <div id="bd">
          <div id="yui-main">
            <div class="yui-b">
              <div class="yui-g" id="dev-js-index-1.0">
                
  <div class="section" id="qimessaging-javascript-1-0">
<span id="js-1-0"></span><h1>QiMessaging JavaScript 1.0<a class="headerlink" href="#qimessaging-javascript-1-0" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Version 1.0 of the library is now deprecated. Please see
<a class="reference internal" href="#js-1-0-migrate"><span>How to migrate from version 1.0 to 2</span></a>.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>QiMessaging provides JavaScript bindings to use QiMessaging services (modules)
in a web browser. It allows you to build HTML5 applications for your robot.</p>
<p>The library was designed to be asynchronous. Most function calls return a
Deferred object, as specified by
<a class="reference external" href="http://api.jquery.com/deferred.promise/">jQuery</a>, but <a class="reference external" href="https://github.com/warpdesign/deferred-js/">reimplemented</a> to avoid shipping the whole
library.
<a class="reference external" href="http://socket.io/">Socket.IO</a> is used to provide bidirectional communication
between the robot and the browser. You may want to get more familiar with these
libraries before going further.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>The client page requires the inclusion of QiMessaging which is hosted on
the robot.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/libs/qimessaging/1.0/qimessaging.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="qisession">
<h2>QiSession<a class="headerlink" href="#qisession" title="Permalink to this headline">¶</a></h2>
<p>The bindings provide only one class: <code class="docutils literal"><span class="pre">QiSession</span></code>. This object connects to the
robot and gets proxies to services.</p>
<p>If the page is hosted on the robot, the constructor does not need any argument.
If the page is <em>not</em> served by the robot, you may pass the hostname or IP of
the robot you want to connect to (e.g. <code class="docutils literal"><span class="pre">&quot;192.168.0.5&quot;</span></code>, <code class="docutils literal"><span class="pre">&quot;nao.local&quot;</span></code>,
etc.).</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QiSession</span><span class="p">();</span>
</pre></div>
</div>
<p>Once the connection is established, two methods are available: <code class="docutils literal"><span class="pre">socket()</span></code> and
<code class="docutils literal"><span class="pre">service()</span></code>.</p>
<div class="section" id="socket">
<span id="js-1-0-socket"></span><h3>socket()<a class="headerlink" href="#socket" title="Permalink to this headline">¶</a></h3>
<p>This function will return the underlying <cite>Socket.Io</cite> object. It is used to deal
with low-level <a class="reference external" href="https://github.com/LearnBoost/socket.io/wiki/Exposed-events#client">socket events</a>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">session</span><span class="p">.</span><span class="nx">socket</span><span class="p">().</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;QiSession connected!&#39;</span><span class="p">);</span>
  <span class="c1">// now you can start using your QiSession</span>
<span class="p">}).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;disconnect&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;QiSession disconnected!&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="service">
<span id="js-1-0-service"></span><h3>service()<a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h3>
<p>You can call this function to get a JavaScript proxy to any service, also known
as modules. Services are JavaScript bound objects providing corresponding
<a class="reference internal" href="../../naoqi/index.html#naoqi-api"><span>NAOqi APIs</span></a> through <a class="reference internal" href="#js-1-0-calls"><span>Calls</span></a> and <a class="reference internal" href="#js-1-0-signals"><span>Signals</span></a>.</p>
<p>In case of success, this method calls the <code class="docutils literal"><span class="pre">done()</span></code> callback with an
object corresponding to the requested service. Otherwise, the <code class="docutils literal"><span class="pre">fail()</span></code>
callback is triggered.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">session</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s2">&quot;ALTextToSpeech&quot;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">tts</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// tts is a proxy to the ALTextToSpeech service</span>
<span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;An error occurred:&quot;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-services">
<h2>Using services<a class="headerlink" href="#using-services" title="Permalink to this headline">¶</a></h2>
<p>Services are JavaScript object exposing methods and signals.</p>
<div class="section" id="calls">
<span id="js-1-0-calls"></span><h3>Calls<a class="headerlink" href="#calls" title="Permalink to this headline">¶</a></h3>
<p>Service calls are only JavaScript function calls returning <a class="reference external" href="http://api.jquery.com/deferred.promise/">Deferred
promises</a>. They are entirely
asynchronous. As previously explained, <code class="docutils literal"><span class="pre">done()</span></code> and <code class="docutils literal"><span class="pre">fail()</span></code> callbacks
will be triggered upon successful completion or not.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">tts</span><span class="p">.</span><span class="nx">getLanguage</span><span class="p">().</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">lang</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;I speak &quot;</span> <span class="o">+</span> <span class="nx">lang</span><span class="p">);</span>
<span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;An error occurred: &quot;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="signals">
<span id="js-1-0-signals"></span><h3>Signals<a class="headerlink" href="#signals" title="Permalink to this headline">¶</a></h3>
<p>Signals are JavaScript objects inside a service, that provide two methods,
<code class="docutils literal"><span class="pre">connect()</span></code> and <code class="docutils literal"><span class="pre">disconnect()</span></code>, respectively to subscribe and unsubscribe.
The first one will return an id that must be used by the second one for
unregistration.</p>
<p>The example below connects to a signal, and once fired, disconnects.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">signalLink</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">serviceDirectory</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">onServiceAdded</span><span class="p">(</span><span class="nx">serviceId</span><span class="p">,</span> <span class="nx">serviceName</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;New service&quot;</span><span class="p">,</span> <span class="nx">serviceId</span><span class="p">,</span> <span class="nx">serviceName</span><span class="p">);</span>
  <span class="nx">serviceDirectory</span><span class="p">.</span><span class="nx">serviceAdded</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">signalLink</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">session</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s2">&quot;ServiceDirectory&quot;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">sd</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">serviceDirectory</span> <span class="o">=</span> <span class="nx">sd</span><span class="p">;</span>
  <span class="nx">serviceDirectory</span><span class="p">.</span><span class="nx">serviceAdded</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">onServiceAdded</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">link</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">signalLink</span> <span class="o">=</span> <span class="nx">link</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;An error occurred: &quot;</span> <span class="o">+</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="compatibility-between-signals-and-almemory">
<h3>Compatibility between Signals and ALMemory<a class="headerlink" href="#compatibility-between-signals-and-almemory" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../../naoqi/core/almemory.html#almemory"><span>ALMemory</span></a> events cannot be directly used as QiMessaging signals. An extra step
is needed, where ALMemory events are converted to signals using
<code class="docutils literal"><span class="pre">ALMemory::subscriber</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">session</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s2">&quot;ALMemory&quot;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ALMemory</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ALMemory</span><span class="p">.</span><span class="nx">subscriber</span><span class="p">(</span><span class="s2">&quot;FrontTactilTouched&quot;</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">subscriber</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// subscriber.signal is a signal associated to &quot;FrontTactilTouched&quot;</span>
    <span class="nx">subscriber</span><span class="p">.</span><span class="nx">signal</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">state</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="s2">&quot;You just touched my head!&quot;</span> <span class="o">:</span> <span class="s2">&quot;Bye bye!&quot;</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-migrate-from-version-1-0-to-2">
<span id="js-1-0-migrate"></span><h2>How to migrate from version 1.0 to 2<a class="headerlink" href="#how-to-migrate-from-version-1-0-to-2" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="index.html#js-2"><span>JavaScript SDK</span></a> is now available. The former 1.0 version is now deprecated and no
longer maintained. You are strongly encouraged to port your code to the new
library. This quick guide will help you transition.</p>
<div class="section" id="library-inclusion">
<h3>Library inclusion<a class="headerlink" href="#library-inclusion" title="Permalink to this headline">¶</a></h3>
<p>You must first change the <code class="docutils literal"><span class="pre">qimessaging.js</span></code> inclusion.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="c">&lt;!-- QiMessaging 1.0 --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/libs/qimessaging/1.0/qimessaging.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<div class="highlight-html"><div class="highlight"><pre><span class="c">&lt;!-- QiMessaging 2 --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;/libs/qimessaging/2/qimessaging.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="qisession-creation">
<h3>QiSession creation<a class="headerlink" href="#qisession-creation" title="Permalink to this headline">¶</a></h3>
<p>Considering a <code class="docutils literal"><span class="pre">QiSession</span></code> connected to <code class="docutils literal"><span class="pre">host</span></code> with the <code class="docutils literal"><span class="pre">connected</span></code> and
<code class="docutils literal"><span class="pre">disconnected</span></code> callbacks registered,</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">host</span> <span class="o">=</span> <span class="s2">&quot;192.168.0.1&quot;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">connected</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;connected&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">disconnected</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;disconnected&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>here is the session creation in 1.0 and how it translates into version 2:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// QiMessaging 1.0</span>
<span class="kd">var</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">QiSession</span><span class="p">(</span><span class="nx">host</span><span class="p">);</span>
<span class="nx">session</span><span class="p">.</span><span class="nx">socket</span><span class="p">().</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;connect&quot;</span><span class="p">,</span> <span class="nx">connected</span><span class="p">);</span>
<span class="nx">session</span><span class="p">.</span><span class="nx">socket</span><span class="p">().</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;disconnect&quot;</span><span class="p">,</span> <span class="nx">disconnected</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// QiMessaging 2</span>
<span class="nx">QiSession</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">connected</span><span class="p">();</span>
<span class="p">},</span> <span class="nx">disconnected</span><span class="p">,</span> <span class="nx">host</span><span class="p">);</span>
</pre></div>
</div>
<p>The first callback will be fired once the <code class="docutils literal"><span class="pre">QiSession</span></code> is connected, and the
second one upon its disconnection.</p>
<p>Please note the created <code class="docutils literal"><span class="pre">QiSession</span></code> is not returned anymore, but given to the
first callback instead. This prevents using the session before it is actually
connected.</p>
<p>As in 1.0, the <code class="docutils literal"><span class="pre">host</span></code> parameter still defaults to <code class="docutils literal"><span class="pre">window.location.host</span></code> if
not given. It <em>cannot</em> accept any protocol, ie. <code class="docutils literal"><span class="pre">192.168.0.1</span></code> and not
<code class="docutils literal"><span class="pre">http://192.168.0.1</span></code>.</p>
</div>
<div class="section" id="removal-of-socket">
<h3>Removal of socket()<a class="headerlink" href="#removal-of-socket" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">socket()</span></code> method of <code class="docutils literal"><span class="pre">QiSession</span></code> was removed, so as to ease backward
compatibility maintenance.</p>
</div>
<div class="section" id="deferred-and-promise">
<h3>Deferred and Promise<a class="headerlink" href="#deferred-and-promise" title="Permalink to this headline">¶</a></h3>
<p>In version 2, <a class="reference external" href="http://api.jquery.com/deferred.promise/">jQuery-like Deferred</a>
were removed in favor of native ECMAScript 6
<a class="reference external" href="https://promisesaplus.com/">Promise/A+</a>, which are now
<a class="reference external" href="http://caniuse.com/#feat=promises">widely available</a>.</p>
<p>If you are currently developing for an older browser, you can use a polyfill
such as:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://www.promisejs.org/polyfills/promise-6.0.0.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<p>As jQuery&#8217;s Deferred do not implement Promises/A+, you will also have to adapt
your API calls as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// QiMessaging 1.0</span>
<span class="nx">proxy</span><span class="p">.</span><span class="nx">method</span><span class="p">().</span><span class="nx">done</span><span class="p">(</span><span class="nx">success</span><span class="p">).</span><span class="nx">fail</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// QiMessaging 2</span>
<span class="nx">proxy</span><span class="p">.</span><span class="nx">method</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="binary-buffer-serialization">
<h3>Binary buffer serialization<a class="headerlink" href="#binary-buffer-serialization" title="Permalink to this headline">¶</a></h3>
<p>Binary data used to be serialized as base64 strings. Buffers are now received
as <code class="docutils literal"><span class="pre">Array</span></code> of unsigned bytes, which also means <code class="docutils literal"><span class="pre">atob()</span></code> shouldn&#8217;t be called
anymore.</p>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          
            
              <div class="yui-b" id="sidebar">
                
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../contents.html">Site map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../news/index.html">What’s new</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index_dev_guide.html">NAOqi - Developer guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/creating_applications/index.html">Creating an application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ref/life/index.html">Programming for a living robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index_tuto.html">Other tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../software/choregraphe/index.html">Choregraphe Suite</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../programming_index.html">SDKs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../python/index.html">Python SDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp/index.html">C++ SDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../java/index_java.html">Java SDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html">JavaScript SDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ros/index_ros.html">ROS Interface</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../deprecated_sdks.html">Former Versions</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="">QiMessaging JavaScript 1.0</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../naoqi/index.html">NAOqi APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libqi/index.html">qi Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ref/index.html">Former NAOqi Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../simulators/simulator_index.html">Simulators</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../home_nao.html"><strong>NAO</strong> - Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home_pepper.html"><strong>Pepper</strong> - Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../home_romeo.html"><strong>Romeo</strong> - Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../legal/notice.html">Legal notices</a></li>
</ul>

    <div id="on-this-page" style="display:none;">
        <h2 id="otp-link">On this page</h2>
        <div id="toc-list">
            <ul>
<li><a class="reference internal" href="#">QiMessaging JavaScript 1.0</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#qisession">QiSession</a><ul>
<li><a class="reference internal" href="#socket">socket()</a></li>
<li><a class="reference internal" href="#service">service()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-services">Using services</a><ul>
<li><a class="reference internal" href="#calls">Calls</a></li>
<li><a class="reference internal" href="#signals">Signals</a></li>
<li><a class="reference internal" href="#compatibility-between-signals-and-almemory">Compatibility between Signals and ALMemory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-migrate-from-version-1-0-to-2">How to migrate from version 1.0 to 2</a><ul>
<li><a class="reference internal" href="#library-inclusion">Library inclusion</a></li>
<li><a class="reference internal" href="#qisession-creation">QiSession creation</a></li>
<li><a class="reference internal" href="#removal-of-socket">Removal of socket()</a></li>
<li><a class="reference internal" href="#deferred-and-promise">Deferred and Promise</a></li>
<li><a class="reference internal" href="#binary-buffer-serialization">Binary buffer serialization</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    </div>
        </div>
      </div>
              </div>
            
          
        </div>
    </main>
    <a href="#0" class="cd-top"></a>
    <div id="ft">
      
      <a title="Glossary" href="../../glossary.html">Glossary</a>
      <a title="Site map" href="../../contents.html">Site map</a>
      <a title="Index" href="../../genindex.html">Index</a>
      <a title="Support" target="_blank" href="https://account.aldebaran.com/support/">Support</a>
      <a title="Contact" target="_blank" href="https://www.aldebaran.com/en/contact">Contact</a>
      <a title="Legal Notices" href="../../legal/notice.html">Legal Notices</a>
      
      
      <img src="https://www.ald.softbankrobotics.com/sites/aldebaran/files/logos-picture/2016_digital_logo_sbr_112x31_0.png" alt="">
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>